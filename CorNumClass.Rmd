---
title: "Correlated Numerical Data Analysis"
author: "Azmi"
date: "07/03/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(pacman)
p_load(haven, tidyverse, summarytools, broom)
```



# Tutorial 1

```{r}
myds <- read_dta("5.1.dta")
head(myds)
myds0 <- myds %>% 
  mutate_if(is.labelled, funs(as_factor(.)))
myds0 <- myds0 %>% 
  mutate(gender = factor(female, labels = c("male","female")),
         socialclass = factor(sclass, labels = c("manager_pro", "intermediate", "working", "unclassified")),
         schooltype = factor(schtype, labels = c("independent", "state")),
         urban = factor(schurban, labels = c("urban", "rural")),
         denom = factor(schdenom, labels = c("Catholic", "other"))) %>% 
  select(caseid, schoolid, score, cohort90, gender, socialclass, schooltype, urban, denom)
head(myds0)
```

```{r}
mydsgdenomurban <- myds0 %>% group_by(denom, urban)
ctable(mydsgdenomurban$socialclass, mydsgdenomurban$schooltype)
```

## Null model

```{r}
lmodnull <- lm(score ~ 1, data = myds0)
summary(lmodnull)
```

## Null Model MLE

```{r}
p_load(lme4)
```

```{r}
multlevmodnull <- lmer(score ~ 1 + (1|schoolid), data = myds0, REML = F)
summary(multlevmodnull)
tidy(multlevmodnull)
```

## Student level - cohort

```{r}
multlevmodcohort <- lmer(score ~ cohort90 + (1|schoolid), data = myds0)
summary(multlevmodcohort)
```

equation - score = 
